{# templates/admin/reports/index.html.twig #}
{% extends 'base.html.twig' %}
{%
block title %}Reportes Administrativos
{% endblock %}
{% block stylesheets %}
	{{ parent() }}
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}
{% block content %}

	<div
		class="rbt-page-banner-wrapper">
		<!-- Start Banner BG Image  -->
		<div class="rbt-banner-image"></div>
		<!-- End Banner BG Image  -->
		<div
			class="rbt-banner-content">
			<!-- Start Banner Content Top  -->
			<div class="rbt-banner-content-top">
				<div class="container">
					<div class="row">
						<div class="col-lg-12 pt-5">
							<!-- Start Breadcrumb Area  -->

							<!-- End Breadcrumb Area  -->

								<div class="title-wrapper pt-5"> <h3 class="h3 mb--0">Reportes Administrativos</h3>
							</div>
							<p class="description"></p>
						</div>
					</div>
				</div>
			</div>
			<!-- End Banner Content Top  -->
		</div>
	</div>

	<div class="rbt-counterup-area rbt-section-overlayping-top rbt-section-gapBottom">
		<div class="container">
			<div
				class="row g-5">
				<!-- Start Single Event  -->
				<div class="col-lg-6 col-md-6 col-12">
					<div class="rbt-card event-grid-card variation-01 rbt-hover">
						<div class="rbt-card-body">
							<h4 class="rbt-card-title">Insights Automáticos</h4>

							<div>
								<ul class="list-group list-group-flush">
									{% for insight in insights %}
										<li class="list-group-item small">
											{{ insight }}
										</li>
									{% endfor %}
								</ul>
							</div>
						</div>
					</div>
				</div>
				<!-- End Single Event  -->

				<div class="col-lg-6 col-md-6 col-12">
					<div class="rbt-card event-grid-card variation-01 rbt-hover">
						<div class="rbt-card-body">
							<h4 class="rbt-card-title">
								Distribución de Cursos por Área
							</h4>

							<div class="card-body">
								<canvas id="categoryChart" height="300"></canvas>
							</div>

							<div></div>
						</div>
					</div>
				</div>
			</div>

			<div
				class="row g-5 mt-2">
				<!-- Gráfico: Ocupación por curso -->

				<div class="col-lg-6 col-md-6 col-12">
					<div class="rbt-card event-grid-card variation-01 rbt-hover">
						<div class="rbt-card-body">
							<h4 class="rbt-card-title">
								Ocupación vs Cupo Máximo por Curso
							</h4>

							<div class="card-body">
								<canvas id="courseChart" height="300"></canvas>
							</div>
						</div>
					</div>
				</div>

				<div class="col-lg-6 col-md-6 col-12">
					<div class="rbt-card event-grid-card variation-01 rbt-hover">
						<div class="rbt-card-body">
							<h4 class="rbt-card-title">
								Carga Académica por Profesor
							</h4>

							<div class="card-body">
								<canvas id="teacherChart" height="300"></canvas>
							</div>
						</div>
					</div>
				</div>

				<!-- Gráfico: Carga de profesores -->
			</div>
		</div>
	</div>

	<div class="rbt-separator-mid">
		<div class="container">
			<hr class="rbt-separator m-0"/>
		</div>
	</div>


{% endblock %}
{% block javascripts %}
	{{ parent() }}

	<script>
		// Gráfico 1: Ocupación por curso
const ctx1 = document.getElementById('courseChart').getContext('2d');
new Chart(ctx1, {
type: 'bar',
data: {
labels: {{ course_labels | raw }},
datasets: [
{
label: 'Inscripciones',
data: {{ enrollment_data | raw }},
backgroundColor: 'rgba(54, 162, 235, 0.6)',
borderColor: 'rgba(54, 162, 235, 1)',
borderWidth: 1
}, {
label: 'Cupo Máximo',
data: {{ capacity_data | raw }},
type: 'line',
fill: false,
borderColor: 'rgba(255, 99, 132, 1)',
tension: 0.1,
yAxisID: 'y1'
}
]
},
options: {
responsive: true,
plugins: {
legend: {
position: 'top'
}
},
scales: {
y: {
beginAtZero: true,
title: {
display: true,
text: 'Número de estudiantes'
}
},
y1: {
position: 'right',
beginAtZero: true,
grid: {
drawOnChartArea: false
}
}
}
}
});

// Gráfico 2: Cursos por categoría
const ctx2 = document.getElementById('categoryChart').getContext('2d');
new Chart(ctx2, {
type: 'pie',
data: {
labels: {{ category_labels | raw }},
datasets: [
{
data: {{ category_data | raw }},
backgroundColor: [
'#FF6384',
'#36A2EB',
'#FFCE56',
'#4BC0C0',
'#9966FF',
'#FF9F40',
'#FF6384'
]
}
]
},
options: {
responsive: true,
plugins: {
legend: {
position: 'bottom'
}
}
}
});

// Gráfico 3: Carga de profesores
const ctx3 = document.getElementById('teacherChart').getContext('2d');
new Chart(ctx3, {
type: 'bar',
data: {
labels: {{ teacher_names | raw }},
datasets: [
{
label: 'Cursos Asignados',
data: {{ teacher_courses | raw }},
backgroundColor: 'rgba(75, 192, 192, 0.6)',
borderColor: 'rgba(75, 192, 192, 1)',
borderWidth: 1
}
]
},
options: {
indexAxis: 'y',
responsive: true,
scales: {
x: {
beginAtZero: true,
title: {
display: true,
text: 'Cantidad de cursos'
}
}
}
}
});
	</script>

{% endblock %}
